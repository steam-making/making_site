{% extends "base.html" %}
{% block content %}

<div class="container mt-4" style="max-width:700px;">

  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <h4 class="mb-1">
        <i class="bi bi-file-earmark-excel text-success me-1"></i>
        차시 엑셀 등록
      </h4>
      <small class="text-muted">
        {{ program.name }} · 커리큘럼 차시 일괄 등록
      </small>
    </div>
  </div>

  <div class="card shadow-sm">
    <div class="card-body">

      <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="d-flex justify-content-between align-items-center mb-3">
            <span class="fw-semibold">
                <i class="bi bi-info-circle me-1"></i>
                엑셀 양식을 먼저 다운로드해서 작성하세요
            </span>

            <a href="{% url 'curriculum_syllabus_excel_template' %}"
                class="btn btn-outline-success btn-sm">
                <i class="bi bi-file-earmark-excel me-1"></i>
                엑셀 템플릿 다운로드
            </a>
        </div>

        <div class="mb-3">
          <label class="form-label fw-semibold">
            <i class="bi bi-upload me-1"></i>
            엑셀 파일 선택
          </label>
          {{ form.excel_file }}
        </div>

        <div class="alert alert-light small">
          <strong>엑셀 양식</strong><br>
          week | title | content | material<br>
          (1행은 헤더, 2행부터 데이터)
        </div>

        <div class="d-flex justify-content-between">
          <a href="{% url 'curriculum_syllabus_list' program.id %}"
             class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> 목록으로
          </a>
          
          <button type="submit" class="btn btn-success">
            <i class="bi bi-file-earmark-arrow-up me-1"></i>
            업로드
          </button>
        </div>

      </form>

    </div>
  </div>

</div>

{% endblock %}
