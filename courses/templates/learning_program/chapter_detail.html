{% extends "base.html" %}
{% load static %}
{% load course_filters %}

{% block content %}
<style>
    /* íƒ€ì…ë³„ ë¼ë²¨ ìƒ‰ìƒ */
    .tag-example { background:#d0e7ff; color:#0b64c0; font-weight:600; padding:3px 8px; border-radius:6px; }
    .tag-problem { background:#ffd6d6; color:#d92323; font-weight:600; padding:3px 8px; border-radius:6px; }
    .tag-project { background:#d7f5dd; color:#259a42; font-weight:600; padding:3px 8px; border-radius:6px; }
    .tag-homework { background:#ffe5c2; color:#d97314; font-weight:600; padding:3px 8px; border-radius:6px; }
</style>

<div class="container mt-4">

    <!-- ì œëª© ì˜ì—­ -->
    <div class="mb-4">
        <h3 class="fw-bold">
            {{ chapter.number }}ì¥ â€“ {{ chapter.title }}
        </h3>

        <!-- ğŸ”¥ ì „ì²´ ì§„ë„ìœ¨ -->
        <div>
            <label class="small text-muted">ì „ì²´ ì§„ë„ìœ¨</label>
            <div class="progress" style="height: 12px;">
                <div class="progress-bar bg-success"
                     role="progressbar"
                     style="width: {{ chapter_progress }}%;">
                </div>
            </div>
            <span class="small text-muted">
                {{ chapter_progress }}%
            </span>
        </div>
    </div>

    <!-- ë¬¸ì œ ëª©ë¡ í…Œì´ë¸” -->
    <div class="table-responsive">
        <table class="table table-hover align-middle shadow-sm">
            <thead class="table-light">
                <tr>
                    <th style="width: 100px;">ë²ˆí˜¸</th>
                    <th style="width: 150px;">ìœ í˜•</th>
                    <th>ë¬¸ì œ ì œëª©</th>
                    <th style="width: 120px;">ìƒíƒœ</th>
                    <th style="width: 120px;">í•™ìŠµ</th>
                </tr>
            </thead>

            <tbody>

            {% for it in items %}
                {% with done=user_progress|get_item:it.id %}
                <tr>

                    <!-- ë¬¸ì œ ë²ˆí˜¸ -->
                    <td class="fw-bold">{{ it.key }}</td>

                    <!-- ğŸ”¥ ìœ í˜• íƒœê·¸ + ì•„ì´ì½˜ -->
                    <td>
                        {% if it.item_type == "example" %}
                            <span class="tag-example">
                                <i class="bi bi-lightbulb"></i> ì˜ˆì œ
                            </span>
                        {% elif it.item_type == "problem" %}
                            <span class="tag-problem">
                                <i class="bi bi-pencil-square"></i> ë¬¸ì œ
                            </span>
                        {% elif it.item_type == "project" %}
                            <span class="tag-project">
                                <i class="bi bi-rocket-takeoff"></i> í”„ë¡œì íŠ¸
                            </span>
                        {% elif it.item_type == "homework" %}
                            <span class="tag-homework">
                                <i class="bi bi-house-check"></i> ê³¼ì œ
                            </span>
                        {% endif %}
                    </td>

                    <!-- ë¬¸ì œ ì œëª© -->
                    <td>{{ it.title }}</td>

                    <!-- ì™„ë£Œ ì—¬ë¶€ -->
                    <td>
                        {% if done %}
                            <span class="text-primary fw-semibold">
                                <i class="bi bi-check-circle-fill"></i> ì™„ë£Œ
                            </span>
                        {% else %}
                            <span class="text-secondary">
                                <i class="bi bi-circle"></i> ë¯¸ì™„ë£Œ
                            </span>
                        {% endif %}
                    </td>

                    <!-- í•™ìŠµ ë²„íŠ¼ -->
                    <td>
                        <a href="{% url 'item_page' it.id %}"
                           class="btn btn-sm {% if done %}btn-outline-primary{% else %}btn-primary{% endif %} w-100">
                            ì‹œì‘í•˜ê¸° â†’
                        </a>
                    </td>

                </tr>
                {% endwith %}
            {% endfor %}
            </tbody>

        </table>
    </div>

    <!-- ë’¤ë¡œê°€ê¸° -->
    <div class="mt-3">
        <a href="{% url 'course_home' program.id %}" class="btn btn-secondary">
            â† ì½”ìŠ¤ ëª©ë¡ìœ¼ë¡œ
        </a>
    </div>

</div>
{% endblock %}
