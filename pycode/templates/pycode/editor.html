{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Python Learning Lab</title>

    <style>
        * { box-sizing: border-box; }
        body { margin: 0; height: 100vh; font-family: Pretendard, sans-serif; }

        .layout { display: flex; height: 100vh; }

        .left-panel {
            width: 27%; background: #fafafa;
            border-right: 1px solid #ddd;
            display: flex; flex-direction: column;
        }
        .middle-panel { width: 43%; display: flex; flex-direction: column; }
        .right-panel { width: 30%; background: #111; color: #0f0; display: flex; flex-direction: column; }

        .header {
            padding: 10px; font-weight: 600;
            background: #f3f3f3; border-bottom: 1px solid #ddd;
        }
        .section { flex: 1; overflow-y: auto; padding: 12px; }

        .problem-button {
            width: 100%; padding: 8px; margin: 3px 0;
            border: 1px solid #ccc; background: white;
            text-align: left; border-radius: 5px; cursor: pointer;
            font-size: 14px;
        }
        .problem-button.active {
            background: #4CAF50; color: white; border-color: #4CAF50;
        }

        #editor { flex: 1; border-top: 1px solid #ddd; }

        .run-area { padding: 10px; background: #f8f8f8; border-top: 1px solid #ddd; text-align: right; }

        .run-btn {
            padding: 7px 14px; background: #4CAF50; border: none;
            color: white; border-radius: 5px; cursor: pointer;
        }
        #output { white-space: pre-wrap; padding: 12px; font-family: Consolas; font-size: 14px; }

        .explain-box, .example-box, .problem-box {
            padding: 10px; border-radius: 5px; margin-bottom: 12px; border: 1px solid #ddd;
        }
        .example-box { background: #eef9ff; border-left: 4px solid #2196F3; }
        .problem-box { background: #fff7e6; border-left: 4px solid #FF9800; }
        pre { background: #f4f4f4; padding: 8px; border-radius: 4px; overflow-x: auto; }
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.js"></script>
</head>

<body>

<div class="layout">

    <!-- 왼쪽 패널 -->
    <div class="left-panel">
        <div class="header">1주차 학습 메뉴</div>
        <div class="section" id="menu"></div>

        <hr>

        <div class="section" id="explain-box"></div>
    </div>

    <!-- 가운데 패널 -->
    <div class="middle-panel">
        <div class="header">코드 작성</div>
        <div id="editor"></div>

        <div class="run-area">
            <button class="run-btn" id="run-btn">▶ 실행</button>
        </div>
    </div>

    <!-- 오른쪽 패널 -->
    <div class="right-panel">
        <div class="header">출력 결과</div>
        <div class="section"><div id="output"></div></div>
    </div>

</div>


<script>
// ⭐ 1주차 콘텐츠 (제목 포함)
const items = {

    // -----------------------------------------
    // 예제 1
    // -----------------------------------------
    "예제1": {
        title: "예제1: print() 함수란?",
        explain: `
            <div class="explain-box">
                <h3>예제1: print() 함수란?</h3>
                <p>print() 함수는 컴퓨터에게 “이 글자를 화면에 보여줘!”라고 명령하는 함수입니다.</p>
            </div>

            <div class="example-box">
                <h4>예시 코드</h4>
                <pre>print("안녕 파이썬!")</pre>

                <h4>예시 출력</h4>
                <pre>안녕 파이썬!</pre>
            </div>
        `
    },

    // -----------------------------------------
    // 예제 2
    // -----------------------------------------
    "예제2": {
        title: "예제2: 여러 줄 출력하는 방법",
        explain: `
            <div class="explain-box">
                <h3>예제2: 여러 줄 출력하기</h3>
                <p>print()를 여러 번 쓰면 여러 줄로 출력됩니다.</p>
            </div>

            <div class="example-box">
                <h4>예시 코드</h4>
<pre>
print("오늘의 시간표")
print("1교시: 영어")
print("2교시: 수학")
</pre>

                <h4>예시 출력</h4>
<pre>
오늘의 시간표
1교시: 영어
2교시: 수학
</pre>
            </div>
        `
    },

    // -----------------------------------------
    // 예제 3
    // -----------------------------------------
    "예제3": {
        title: "예제3: 줄바꿈 \\n 소개",
        explain: `
            <div class="explain-box">
                <h3>예제3: 줄바꿈(\\n) 사용하기</h3>
                <p>문자열 안에 \\n 을 넣으면 줄바꿈이 됩니다.</p>
            </div>

            <div class="example-box">
                <h4>예시 코드</h4>
<pre>
print("안녕!\\n반가워!")
</pre>

                <h4>예시 출력</h4>
<pre>
안녕!
반가워!
</pre>
            </div>
        `
    },

    // -----------------------------------------
    // 미니 프로젝트
    // -----------------------------------------
    "미니 프로젝트": {
        title: "미니 프로젝트: 콘솔 명함 만들기",
        explain: `
            <div class="explain-box">
                <h3>미니 프로젝트: 콘솔 명함 만들기</h3>
                <p>오늘 배운 print()만 이용해 나만의 콘솔 명함을 만들어 보세요.</p>
            </div>

            <div class="example-box">
                <h4>완성 예시 출력</h4>
<pre>
====================
이름 : 홍길동
학년 : 초6
취미 : 게임, 로봇 코딩
====================
</pre>

                <h4>참고용 예시 코드</h4>
<pre>
print("====================")
print("이름 : 홍길동")
print("학년 : 초6")
print("취미 : 게임, 로봇 코딩")
print("====================")
</pre>
                <p style="color:#d33; font-size:13px;">※ 학생은 직접 만들어보는 것이 목표라, 에디터는 비워두기!</p>
            </div>
        `
    },

    // -----------------------------------------
    // 문제 1
    // -----------------------------------------
    "문제1": {
        title: "문제1: 좋아하는 음식 3개 출력",
        explain: `
            <div class="problem-box">
                <h3>[문제1] 좋아하는 음식 3개 출력</h3>
                <p>print()를 이용해 좋아하는 음식 3개를 출력하세요.</p>

                <h4>예시 출력</h4>
<pre>
내가 좋아하는 음식:
초밥
피자
라면
</pre>
            </div>
        `
    },

    // -----------------------------------------
    // 문제 2
    // -----------------------------------------
    "문제2": {
        title: "문제2: 자기소개 여러 줄 출력",
        explain: `
            <div class="problem-box">
                <h3>[문제2] 자기소개 여러 줄 출력</h3>
                <p>\\n 또는 여러 개의 print()를 이용해 자기소개를 3줄로 출력하세요.</p>

                <h4>예시 출력</h4>
<pre>
안녕하세요!
저는 6학년입니다.
파이썬을 배우는 중입니다.
</pre>
            </div>
        `
    },

    // -----------------------------------------
    // 문제 3
    // -----------------------------------------
    "문제3": {
        title: "문제3: 친구와 대화 출력",
        explain: `
            <div class="problem-box">
                <h3>[문제3] 친구와 대화 출력</h3>
                <p>친구 둘이 대화를 나누는 내용을 print()로 출력하세요.</p>

                <h4>예시 출력</h4>
<pre>
철수: 뭐해?
영희: 파이썬 공부해!
철수: 오! 나도 배워볼래!
</pre>
            </div>
        `
    },

    // -----------------------------------------
    // 과제 1
    // -----------------------------------------
    "과제1": {
        title: "과제1: 오늘 할 일 5개 출력",
        explain: `
            <div class="problem-box">
                <h3>[과제1] 오늘의 할 일 5개 출력</h3>

                <h4>예시 출력</h4>
<pre>
[오늘의 할 일]
1. 수학 숙제
2. 파이썬 문제 풀기
3. 운동하기
4. 책 20쪽 읽기
5. 방 정리
</pre>
            </div>
        `
    },

    // -----------------------------------------
    // 과제 2
    // -----------------------------------------
    "과제2": {
        title: "과제2: 좋아하는 유튜버 출력",
        explain: `
            <div class="problem-box">
                <h3>[과제2] 좋아하는 유튜버 3명 출력</h3>

                <h4>예시 출력</h4>
<pre>
내가 좋아하는 유튜버:
1) 천재소년코딩
2) 로봇만드는초딩
3) 게임하는과학자
</pre>
            </div>
        `
    },

    // -----------------------------------------
    // 과제 3
    // -----------------------------------------
    "과제3": {
        title: "과제3: 여행 계획 출력",
        explain: `
            <div class="problem-box">
                <h3>[과제3] 여행 계획 출력</h3>

                <h4>예시 출력</h4>
<pre>
2025년 여행 계획
1. 서울 → 대전
2. 대전 → 광주
3. 광주 → 부산
</pre>
            </div>
        `
    },

    // -----------------------------------------
    // 과제 4
    // -----------------------------------------
    "과제4": {
        title: "과제4: 오늘의 다짐 출력",
        explain: `
            <div class="problem-box">
                <h3>[과제4] 오늘의 다짐</h3>

                <h4>예시 출력</h4>
<pre>
오늘의 다짐:
"포기하지 말고 끝까지 해보자!"
</pre>
            </div>
        `
    }
};



// ⭐ 왼쪽 메뉴 생성
let menuDiv = document.getElementById("menu");
Object.keys(items).forEach(key => {
    let btn = document.createElement("button");
    btn.className = "problem-button";
    btn.textContent = items[key].title;  // ← 제목 함께 표시
    btn.onclick = () => loadItem(key);
    menuDiv.appendChild(btn);
});


// ⭐ ACE editor 세팅
let editor = ace.edit("editor");
editor.setTheme("ace/theme/monokai");
editor.session.setMode("ace/mode/python");
editor.setFontSize(15);


// ⭐ 콘텐츠 로드
function loadItem(key) {
    const item = items[key];

    // 설명 넣기
    document.getElementById("explain-box").innerHTML = item.explain;

    // ⭐ 코딩 영역은 항상 비우기
    editor.setValue("", -1);

    // active 버튼 표시
    document.querySelectorAll(".problem-button").forEach(btn => {
        btn.classList.toggle("active", btn.textContent === item.title);
    });
}

// 첫 로딩 → 예제1
loadItem("예제1");


// ⭐ 실행
document.getElementById("run-btn").onclick = function () {
    let code = editor.getValue();

    fetch("{% url 'run_code' %}", {
        method: "POST",
        headers: {
            "Content-Type": "application/x-www-form-urlencoded",
            "X-CSRFToken": "{{ csrf_token }}",
        },
        body: "code=" + encodeURIComponent(code)
    })
    .then(res => res.json())
    .then(data => {
        document.getElementById("output").innerText = data.output;
    });
};
</script>

</body>
</html>
