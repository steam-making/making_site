{% extends "base.html" %}
{% load humanize %}
{% block content %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4><i class="bi bi-bar-chart"></i> ë‹¨ê³„ì—… í†µê³„</h4>
    <a href="{% url 'levelup_list' %}" class="btn btn-outline-secondary">
      <i class="bi bi-list-ul"></i> ëª©ë¡ìœ¼ë¡œ
    </a>
  </div>

  <div class="row mt-3">
    <div class="col-12 col-lg-6">
      <h5 class="fw-semibold">ğŸ“… ì›”ë³„ ë‹¨ê³„ì—… ìš”ì•½</h5>
      <table class="table table-bordered table-sm text-center">
        <thead class="table-light"><tr><th>ë…„ì›”</th><th>ì¸ì›ìˆ˜</th><th>ì´ê¸ˆì•¡</th></tr></thead>
        <tbody>
          {% for row in monthly_data %}
          <tr>
            <td>{{ row.year_month }}</td>
            <td>{{ row.count|intcomma }}ëª…</td>
            <td>{{ row.total_price|intcomma }}ì›</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    <div class="col-12 col-lg-6">
      <canvas id="levelupChart"></canvas>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('levelupChart');
new Chart(ctx, {
  type: 'bar',
  data: {
    labels: [{% for row in monthly_data %}'{{ row.year_month }}',{% endfor %}],
    datasets: [{
      label: 'ë‹¨ê³„ì—… ì¸ì›',
      data: [{% for row in monthly_data %}{{ row.count }},{% endfor %}],
      backgroundColor: 'rgba(54, 162, 235, 0.6)'
    }]
  },
  options: { scales: { y: { beginAtZero: true } } }
});
</script>
{% endblock %}
